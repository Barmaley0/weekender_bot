import logging

from aiogram.types import Message

import src.bot.db.repositories.admin_repository as req_admin
import src.bot.db.repositories.user_repository as req_user
import src.bot.keyboards.builders as kb


logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)


async def get_text_command_start(message: Message) -> None:
    if not message.from_user:
        return

    try:
        is_user_data = await req_user.user_data_exists(message.from_user.id)
        is_user_admin = await req_admin.is_admin(message.from_user.id)

        if is_user_data:
            await message.answer(
                f"""
<b>–ü—Ä–∏–≤–µ—Ç, {f'{message.from_user.first_name}' if message.from_user.first_name else ''}! –¢—ã –≤ —É—é—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ Weekender.</b>
–ó–¥–µ—Å—å –ª—é–¥–∏ –Ω–∞—Ö–æ–¥—è—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Å–≤–æ–∏—Ö –ª—é–¥–µ–π —Ä—è–¥–æ–º ‚Äî –¥–ª—è –¥—Ä—É–∂–±—ã, –ø–æ–¥–¥–µ—Ä–∂–∫–∏, —Ñ–ª–∏—Ä—Ç–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∫–ª–∞—Å—Å–Ω—ã—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö –≤–º–µ—Å—Ç–µ. 
üíå –ó–∞–ø–æ–ª–Ω–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∞–Ω–∫–µ—Ç—É ‚Äî –∏ –º—ã –ø–æ–¥–±–µ—Ä—ë–º —Ç–µ–±–µ: ‚Äî —Å–æ–±—ã—Ç–∏—è, –≥–¥–µ –º–æ–∂–Ω–æ –±—ã—Ç—å —Å–æ–±–æ–π ‚Äî –Ω–æ–≤—ã—Ö –∑–Ω–∞–∫–æ–º—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—ã –Ω–∞ –æ–¥–Ω–æ–π –≤–æ–ª–Ω–µ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å —á–∞—Å—Ç—å—é —Ç–æ–ø–æ–≤–æ–≥–æ –∫–æ–º—å—é–Ω–∏—Ç–∏.

‚ÄºÔ∏è –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–æ—Ç–æ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ username –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –ò–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.  

–í—Å—ë –ø—Ä–æ—Å—Ç–æ: —Ç—ã —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—à—å –Ω–µ–º–Ω–æ–≥–æ –æ —Å–µ–±–µ ‚Äî –∞ –º—ã –ø–æ–¥–±–∏—Ä–∞–µ–º —Ç–µ–±–µ —ç–º–æ—Ü–∏–∏ ‚ú® –ù—É —á—Ç–æ, –Ω–∞—á–Ω—ë–º?
                """,
                reply_markup=await kb.get_main_kb(user_data_exists=is_user_data, is_admin=is_user_admin),
                parse_mode='html',
            )
        else:
            await message.answer(
                f"""
<b>–ü—Ä–∏–≤–µ—Ç, {f'{message.from_user.first_name}' if message.from_user.first_name else ''}! –¢—ã –≤ —É—é—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ Weekender.</b>
–ó–¥–µ—Å—å –ª—é–¥–∏ –Ω–∞—Ö–æ–¥—è—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Å–≤–æ–∏—Ö –ª—é–¥–µ–π —Ä—è–¥–æ–º ‚Äî –¥–ª—è –¥—Ä—É–∂–±—ã, –ø–æ–¥–¥–µ—Ä–∂–∫–∏, —Ñ–ª–∏—Ä—Ç–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∫–ª–∞—Å—Å–Ω—ã—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö –≤–º–µ—Å—Ç–µ. 
üíå –ó–∞–ø–æ–ª–Ω–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∞–Ω–∫–µ—Ç—É ‚Äî –∏ –º—ã –ø–æ–¥–±–µ—Ä—ë–º —Ç–µ–±–µ: ‚Äî —Å–æ–±—ã—Ç–∏—è, –≥–¥–µ –º–æ–∂–Ω–æ –±—ã—Ç—å —Å–æ–±–æ–π ‚Äî –Ω–æ–≤—ã—Ö –∑–Ω–∞–∫–æ–º—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—ã –Ω–∞ –æ–¥–Ω–æ–π –≤–æ–ª–Ω–µ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å —á–∞—Å—Ç—å—é —Ç–æ–ø–æ–≤–æ–≥–æ –∫–æ–º—å—é–Ω–∏—Ç–∏.

‚ÄºÔ∏è –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–æ—Ç–æ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ username –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –ò–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.  

–í—Å—ë –ø—Ä–æ—Å—Ç–æ: —Ç—ã —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—à—å –Ω–µ–º–Ω–æ–≥–æ –æ —Å–µ–±–µ ‚Äî –∞ –º—ã –ø–æ–¥–±–∏—Ä–∞–µ–º —Ç–µ–±–µ —ç–º–æ—Ü–∏–∏ ‚ú® –ù—É —á—Ç–æ, –Ω–∞—á–Ω—ë–º?
                """,
                reply_markup=await kb.get_main_kb(user_data_exists=is_user_data, is_admin=is_user_admin),
                parse_mode='html',
            )
    except Exception as e:
        logger.error(f'Errof checking user data: {e}')
